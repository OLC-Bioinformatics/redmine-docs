<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://olc-bioinformatics.github.io/redmine-docs/analysis/primerfinder/">
        <link rel="shortcut icon" href="../../img/favicon.ico">

	<title>PrimerFinder - OLC Redmine Automator</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">OLC Redmine Automator</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">Home</a>
                </li>
            
            
            
                <li >
                    <a href="../../getting_started/">Getting Started</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Data <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../data/external_retrieve/">External Retrieve</a>
                        </li>
                    
                        <li >
                            <a href="../../data/report_retrieve/">Report Retrieve</a>
                        </li>
                    
                        <li >
                            <a href="../../data/sra_upload/">SRA Upload</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Analysis <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../amrsummary/">AMRsummary</a>
                        </li>
                    
                        <li >
                            <a href="../autoclark/">AutoCLARK</a>
                        </li>
                    
                        <li >
                            <a href="../confindr/">ConFindr</a>
                        </li>
                    
                        <li >
                            <a href="../cowsnphr/">COWSNPhR</a>
                        </li>
                    
                        <li >
                            <a href="../closerelatives/">CloseRelatives</a>
                        </li>
                    
                        <li >
                            <a href="../ectyper/">ECTyper</a>
                        </li>
                    
                        <li >
                            <a href="../diversitree/">DiversiTree</a>
                        </li>
                    
                        <li >
                            <a href="../geneseekr/">GeneSeekr</a>
                        </li>
                    
                        <li >
                            <a href="../mobsuite/">MobSuite</a>
                        </li>
                    
                        <li >
                            <a href="../neartree/">NearTree</a>
                        </li>
                    
                        <li >
                            <a href="../plasmidborneidentity/">PlasmidBorneIdentity</a>
                        </li>
                    
                        <li >
                            <a href="../pointfinder/">PointFinder</a>
                        </li>
                    
                        <li class="active">
                            <a href="./">PrimerFinder</a>
                        </li>
                    
                        <li >
                            <a href="../prokka/">Prokka</a>
                        </li>
                    
                        <li >
                            <a href="../psortb/">PSORTb</a>
                        </li>
                    
                        <li >
                            <a href="../resfinder/">ResFinder</a>
                        </li>
                    
                        <li >
                            <a href="../sipprverse/">sipprverse</a>
                        </li>
                    
                        <li >
                            <a href="../snvphyl/">SNVPhyl</a>
                        </li>
                    
                        <li >
                            <a href="../staramr/">staramr</a>
                        </li>
                    
                        <li >
                            <a href="../strainmash/">StrainMash</a>
                        </li>
                    
                        <li >
                            <a href="../wgsassembly/">WGS Assembly</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Internal Use <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../internal_only/merge/">Merge</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li >
                    <a href="../../troubleshooting/">Troubleshooting</a>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li >
                    <a rel="next" href="../pointfinder/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../prokka/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#primerfinder">PrimerFinder</a></li>
        
            <li><a href="#what-does-it-do">What does it do?</a></li>
        
            <li><a href="#how-do-i-use-it">How do I use it?</a></li>
        
            <li><a href="#how-long-does-it-take">How long does it take?</a></li>
        
            <li><a href="#what-can-go-wrong">What can go wrong?</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="primerfinder">PrimerFinder</h1>
<h3 id="what-does-it-do">What does it do?</h3>
<p>The PrimerFinder performs <em>in silico</em> PCR analyses on FASTA and FASTQ formatted files.</p>
<p>There are two different modules:</p>
<p><img alt="PrimerFinder Legacy" src="../../img/primer_finder_legacy.png" /> <img alt="PrimerFinder Supremacy" src="../../img/primer_finder_supremacy.png" /></p>
<p><strong>PrimerFinder Legacy</strong> computes primer binding and amplicon statistics on FASTA formatted files using the now retired ePCR 
suite of tools from NCBI. </p>
<p><strong>PrimerFinder Supremacy</strong> is able to process FASTA- and FASTQ-formatted files. If using FASTQ files, 
<a href="https://sourceforge.net/projects/bbmap/">BBMap</a> is employed to bait out reads containing primer sequences. A second 
round of baiting is performed using the previously-baited reads. Contigs are assembled by <a href="http://cab.spbu.ru/software/spades/">SPAdes</a> with only the baited reads. </p>
<p>For both FASTA-formatted files and contigs assembled from FASTQ-formatted files, primers are 
BLASTed against contigs, and outputs are parsed to determine primer binding, and amplicon statistics</p>
<h3 id="how-do-i-use-it">How do I use it?</h3>
<h4 id="subject">Subject</h4>
<p>In the <code>Subject</code> field, put <code>primer_finder</code>. Spelling counts, but case sensitivity does not.</p>
<h4 id="description">Description</h4>
<p>In the <code>Description</code> field, you must provide:</p>
<p><strong>Required Components</strong></p>
<ol>
<li>
<p><code>program=requested_program</code></p>
<ul>
<li>acceptable programs are <code>legacy</code> and <code>supremacy</code></li>
</ul>
</li>
<li>
<p><code>analysis=requested_analysis</code></p>
<ul>
<li>
<p>acceptable analyses are <code>custom</code> and <code>vtyper</code></p>
<ul>
<li>
<p><code>custom</code> analyses require a FASTA-formatted file of primers you wish to use (see Attachments section for 
additional details)</p>
</li>
<li>
<p><code>vtyper</code> analyses will use the primer set from the vtyper tool</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>a list of SEQIDs (one per line)</p>
</li>
</ol>
<p><strong>Optional Components</strong></p>
<p>In order to customise your PrimerFinder analyses, several settings can be optionally modified</p>
<ul>
<li>Number of mismatches allowed.<ul>
<li>default is <code>2</code></li>
<li>options are <code>0</code>, <code>1</code>, <code>2</code>, <code>3</code>. Anything else will return an error</li>
<li>modify as follows:<ul>
<li><code>mismatches=1</code></li>
</ul>
</li>
</ul>
</li>
<li>Format of sequence files to use (note that PrimerFinder legacy will still use FASTA-formatted files even if you try 
to specify FASTQ)<ul>
<li>default is <code>fasta</code></li>
<li>options are: <code>fasta</code> and <code>fastq</code></li>
<li>modify as follows:<ul>
<li><code>format=fastq</code></li>
</ul>
</li>
</ul>
</li>
<li>K-mer size to use for SPAdes assembly<ul>
<li>default is <code>55,77,99,127</code></li>
<li>either provide and integer, e.g. <code>33</code>, or a comma-separated list, e.g. <code>21,33,55</code></li>
<li>modify as follows:<ul>
<li><code>kmersize=33</code> <em>OR</em></li>
<li><code>kmersize=21,33,55</code></li>
</ul>
</li>
</ul>
</li>
<li>Export amplicons in PrimerFinder Legacy (amplicons are created by default by PrimerFinder Supremacy)<ul>
<li>default is <code>False</code></li>
<li>modify as follows:<ul>
<li><code>exportamplicons</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="attachments">Attachments</h4>
<p>For <code>custom</code> analyses, you are required to attach a FASTA-formatted file containing the primer set(s) you wish analysed. 
The file must have the following format:</p>
<pre><code>&gt;gene1-F
seq
&gt;gene1-R
seq
&gt;gene2-F1
seq
&gt;gene2-R1
seq
&gt;gene2-F2
seq
&gt;gene2-R2
seq
.....
</code></pre>
<p>You are allowed to use IUPAC degenerate bases in this file. 
<strong>Please don't add too many degenerate bases, as the number of primers combinations can increase quickly.</strong></p>
<pre><code># Dictionary of degenerate IUPAC codes
iupac = {
    'R': ['A', 'G'],
    'Y': ['C', 'T'],
    'S': ['C', 'G'],
    'W': ['A', 'T'],
    'K': ['G', 'T'],
    'M': ['A', 'C'],
    'B': ['C', 'G', 'T'],
    'D': ['A', 'G', 'T'],
    'H': ['A', 'C', 'T'],
    'V': ['A', 'C', 'G'],
    'N': ['A', 'C', 'G', 'T'],
    '-': ['-']
}
</code></pre>
<h4 id="examples">Examples</h4>
<p>Example PrimerFinder analyses:</p>
<p>PrimerFinder Legacy, custom analyses <a href="https://redmine.biodiversity.agr.gc.ca/issues/15776">issue 15776</a></p>
<p>PrimerFinder Legacy, vtyper analyses <a href="https://redmine.biodiversity.agr.gc.ca/issues/15777">issue 15777</a></p>
<p>PrimerFinder Supremacy, custom analyses, FASTA format <a href="https://redmine.biodiversity.agr.gc.ca/issues/15778">issue 15778</a></p>
<p>PrimerFinder Supremacy, custom analyses, FASTQ format <a href="https://redmine.biodiversity.agr.gc.ca/issues/15780">issue 15780</a></p>
<h4 id="interpreting-results">Interpreting Results</h4>
<p><strong>PrimerFinder Legacy</strong></p>
<p>PrimerFinder Legacy will upload <code>ePCR_report.csv</code>, which contains the strain name, gene name as parsed from the primer file, location of the calculated amplicon, the size of the amplicon,
the name of the contig on which the amplicon was found, the total number of mismatches between the primer set and the target sequence, and the primers used to create the amplicon.</p>
<p>Here's an example created the example primer file from the <code>Attachments</code> section of this document:</p>
<table>
<thead>
<tr>
<th>Sample</th>
<th>Gene</th>
<th>GenomeLocation</th>
<th>AmpliconSize</th>
<th>Contig</th>
<th>TotalMismatches</th>
<th>PrimerSet</th>
</tr>
</thead>
<tbody>
<tr>
<td>2014-SEQ-1390</td>
<td>gene1</td>
<td>30506-30699</td>
<td>194</td>
<td>2014-SEQ-1390_1_length_680177_cov_29.8782_ID_2219</td>
<td>0</td>
<td>gene1_0_0</td>
</tr>
<tr>
<td>2014-SEQ-1390</td>
<td>gene2</td>
<td>476139-476423</td>
<td>285</td>
<td>2014-SEQ-1390_32_length_32477_cov_33.4201_ID_2281</td>
<td>1</td>
<td>gene2_1_1</td>
</tr>
</tbody>
</table>
<p>Note that the way the primer set is numbered is based on the number of primer sets with the same gene name: <em>gene1</em> had one primer set, <code>gene1-F</code> and <code>gene1-R</code>, and these are represented as <code>gene1_0_0</code>. There were two
primer sets for <em>gene2</em>, and in this example <code>gene2-F2</code> and <code>gene2-R2</code> annealed (with one mismatch)</p>
<p>If requested, amplicon sequences for each match will be created. Using the same example as above <code>2014-SEQ-1390_amplicons.fa</code> will contain:</p>
<pre><code>&gt;2014-SEQ-1390_2014-SEQ-1390_1_length_680177_cov_29.8782_ID_2219_476139_476423_gene1_0_0
amplicon..... 
&gt;2014-SEQ-1390_2014-SEQ-1390_32_length_32477_cov_33.4201_ID_2281_27409_27668_gene2_1_1
amplicon.....
</code></pre>
<p><strong>PrimerFinder Supremacy</strong></p>
<p>PrimerFinder Supremacy will generate <code>ePCR_report.csv</code>, with the following fields: strain name, gene name parsed from the primer file, location of the amplicon, size of the amplicon, 
name of contig on which the amplicon was found, the forward and reverse primers used to create the amplicon, the number of mismatches for the forward and reverse primers.</p>
<p>Here's an example created from the example primer file from the <code>Attachments</code> section of this document:</p>
<table>
<thead>
<tr>
<th>Sample</th>
<th>Gene</th>
<th>GenomeLocation</th>
<th>AmpliconSize</th>
<th>Contig</th>
<th>ForwardPrimers</th>
<th>ReversePrimers</th>
<th>ForwardMismatches</th>
<th>ReverseMismatches</th>
</tr>
</thead>
<tbody>
<tr>
<td>2014-SEQ-1390</td>
<td>gene1</td>
<td>30506-30699</td>
<td>194</td>
<td>2014-SEQ-1390_1_length_680177_cov_29.8782_ID_2219</td>
<td>gene1-F_0</td>
<td>gene1-R_0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>2014-SEQ-1390</td>
<td>gene2</td>
<td>476139-476423</td>
<td>285</td>
<td>2014-SEQ-1390_32_length_32477_cov_33.4201_ID_2281</td>
<td>gene2-F2_0</td>
<td>gene2-R2_0</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>Note that the primer names have <code>_0</code> appended to the end. In the case of IUPAC bases being present in the primer sequence, this number will be incremented for each primer created to satisfy all possible 
combinations. </p>
<p>Amplicon sequences are always included. Using the same example as above, <code>2014-SEQ-1390_amplicons.fa</code> will contain:</p>
<pre><code>&gt;2014-SEQ-1390_2014-SEQ-1390_1_length_680177_cov_29.8782_ID_2219_476139_476423_gene1-F_0_gene1-R_0
amplicon
&gt;2014-SEQ-1390_2014-SEQ-1390_32_length_32477_cov_33.4201_ID_2281_27409_27668_gene2-F2_0_gene2-R2_0
amplicon
</code></pre>
<p>Raw BLAST results are also uploaded. In the example above, <code>2014-SEQ-1390_rawresults.csv</code> will contain:</p>
<table>
<thead>
<tr>
<th>qseqid</th>
<th>sseqid</th>
<th>positive</th>
<th>mismatch</th>
<th>gaps</th>
<th>evalue</th>
<th>bitscore</th>
<th>slen</th>
<th>length</th>
<th>qstart</th>
<th>qend</th>
<th>qseq</th>
<th>sstart</th>
<th>send</th>
<th>sseq</th>
</tr>
</thead>
<tbody>
<tr>
<td>2014-SEQ-1390_1_length_680177_cov_29.8782_ID_2219</td>
<td>gene1-R_0</td>
<td>25</td>
<td>0</td>
<td>0</td>
<td>3.07E-07</td>
<td>50.1</td>
<td>25</td>
<td>25</td>
<td>476399</td>
<td>476423</td>
<td>TACGGTTCCTTTGACGGTGCGATGA</td>
<td>25</td>
<td>1</td>
<td>TACGGTTCCTTTGACGGTGCGATGA</td>
</tr>
<tr>
<td>2014-SEQ-1390_1_length_680177_cov_29.8782_ID_2219</td>
<td>gene1-F_0</td>
<td>25</td>
<td>0</td>
<td>0</td>
<td>3.07E-07</td>
<td>50.1</td>
<td>25</td>
<td>25</td>
<td>476139</td>
<td>476163</td>
<td>GTGAAATTATCGCCACGTTCGGGCA</td>
<td>1</td>
<td>25</td>
<td>GTGAAATTATCGCCACGTTCGGGCA</td>
</tr>
<tr>
<td>2014-SEQ-1390_32_length_32477_cov_33.4201_ID_2281</td>
<td>gene2-F2_0</td>
<td>20</td>
<td>1</td>
<td>0</td>
<td>4.41E-06</td>
<td>42.1</td>
<td>21</td>
<td>21</td>
<td>27648</td>
<td>27668</td>
<td>CGCCTTATTATACGACCAAAG</td>
<td>21</td>
<td>1</td>
<td>CGCCTTATTTTACGACCAAAG</td>
</tr>
<tr>
<td>2014-SEQ-1390_32_length_32477_cov_33.4201_ID_2281</td>
<td>gene2-R2_0</td>
<td>20</td>
<td>0</td>
<td>0</td>
<td>1.74E-05</td>
<td>40.1</td>
<td>20</td>
<td>20</td>
<td>27409</td>
<td>27428</td>
<td>TGCCCAAAGCAGAGAGATTC</td>
<td>1</td>
<td>20</td>
<td>TGCCCAAAGCAGAGAGATTC</td>
</tr>
</tbody>
</table>
<h3 id="how-long-does-it-take">How long does it take?</h3>
<p>PrimerFinder Legacy and PrimerFinder Supremacy on FASTA mode are very fast (seconds per sample), while PrimerFinder Supremacy FASTQ mode is relatively slow (a few minutes per sample)</p>
<h3 id="what-can-go-wrong">What can go wrong?</h3>
<ol>
<li>Requested SEQIDs are not available. </li>
<li>Not including the <code>program=requested_program</code> component, or requesting an unsupported program</li>
<li>Not including the <code>analysis=requested_analysis</code> component, or requesting an unsupported analysis</li>
<li>Specifying an unsupported number of <code>mismatches</code></li>
<li>Incorrectly formatted <code>kmersize</code></li>
<li>Attaching an incorrectly formatted primer file, or not including a primer file for <code>custom</code> analyses</li>
<li>?</li>
</ol>
<p>If anything goes wrong, an error message explaining the error should be returned.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
            <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
    </body>
</html>