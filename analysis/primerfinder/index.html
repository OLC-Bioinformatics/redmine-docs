<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Primerfinder - OLC Redmine Automator</title>
  

  <link rel="shortcut icon" href="../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Primerfinder";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> OLC Redmine Automator</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Home</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../getting_started/">Getting started</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../troubleshooting/">Troubleshooting</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Analysis</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../amrsummary/">Amrsummary</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../autoclark/">Autoclark</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../bcgtree/">Bcgtree</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../cardrgi/">Cardrgi</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../closerelatives/">Closerelatives</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../confindr/">Confindr</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../cowsnphr/">Cowsnphr</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../diversitree/">Diversitree</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../drep/">Drep</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../eCGF/">eCGF</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../ectyper/">Ectyper</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../fastqc/">Fastqc</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../geneseekr/">Geneseekr</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../intimintyper/">Intimintyper</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../kma/">Kma</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../kraken2/">Kraken2</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../mashtree/">Mashtree</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../metaphlan/">Metaphlan</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../mobsuite/">Mobsuite</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../neartree/">Neartree</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../plasmidborneidentity/">Plasmidborneidentity</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../pointfinder/">Pointfinder</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Primerfinder</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#primerfinder">PrimerFinder</a></li>
                
                    <li><a class="toctree-l4" href="#what-does-it-do">What does it do?</a></li>
                
                    <li><a class="toctree-l4" href="#how-do-i-use-it">How do I use it?</a></li>
                
                    <li><a class="toctree-l4" href="#how-long-does-it-take">How long does it take?</a></li>
                
                    <li><a class="toctree-l4" href="#what-can-go-wrong">What can go wrong?</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../prokka/">Prokka</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../psortb/">Psortb</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../pyseer/">Pyseer</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../resfinder/">Resfinder</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../roary/">Roary</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../sequence_extractor/">Sequence extractor</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../sipprverse/">Sipprverse</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../snvphyl/">Snvphyl</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../staramr/">Staramr</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../strainmash/">Strainmash</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../wgsassembly/">Wgsassembly</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Data</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../data/external_retrieve/">External retrieve</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../data/report_retrieve/">Report retrieve</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../data/sra_upload/">Sra upload</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Tutorials</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tutorials/create_environment/">Create environment</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tutorials/create_pages/">Create pages</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tutorials/edit_pages/">Edit pages</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tutorials/publish_changes/">Publish changes</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Internal only</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../internal_only/merge/">Merge</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">OLC Redmine Automator</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Analysis &raquo;</li>
        
      
    
    <li>Primerfinder</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/OLC-LOC-Bioinformatics/OLCRedmineAutomator" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="primerfinder">PrimerFinder</h1>
<h3 id="what-does-it-do">What does it do?</h3>
<p>The PrimerFinder performs <em>in silico</em> PCR analyses on FASTA and FASTQ formatted files.</p>
<p>There are two different modules:</p>
<p><img alt="PrimerFinder Legacy" src="../../img/primer_finder_legacy.png" /> <img alt="PrimerFinder Supremacy" src="../../img/primer_finder_supremacy.png" /></p>
<p><strong>PrimerFinder Legacy</strong> computes primer binding and amplicon statistics on FASTA formatted files using the now retired ePCR 
suite of tools from NCBI. </p>
<p><strong>PrimerFinder Supremacy</strong> is able to process FASTA- and FASTQ-formatted files. If using FASTQ files, 
<a href="https://sourceforge.net/projects/bbmap/">BBMap</a> is employed to bait out reads containing primer sequences. A second 
round of baiting is performed using the previously-baited reads. Contigs are assembled by 
<a href="http://cab.spbu.ru/software/spades/">SPAdes</a> with only the baited reads. </p>
<p>For both FASTA-formatted files and contigs assembled from FASTQ-formatted files, primers are 
BLASTed against contigs, and outputs are parsed to determine primer binding, and amplicon statistics</p>
<h3 id="how-do-i-use-it">How do I use it?</h3>
<h4 id="subject">Subject</h4>
<p>In the <code>Subject</code> field, put <code>primer_finder</code>. Spelling counts, but case sensitivity does not.</p>
<h4 id="description">Description</h4>
<p>In the <code>Description</code> field, you must provide:</p>
<p><strong>Required Components</strong></p>
<ol>
<li>
<p><code>program=requested_program</code></p>
<ul>
<li>acceptable programs are <code>legacy</code> and <code>supremacy</code></li>
</ul>
</li>
<li>
<p><code>analysis=requested_analysis</code></p>
<ul>
<li>
<p>acceptable analyses are <code>custom</code> and <code>vtyper</code></p>
<ul>
<li>
<p><code>custom</code> analyses require a FASTA-formatted file of primers you wish to use (see Attachments section for 
additional details)</p>
</li>
<li>
<p><code>vtyper</code> analyses will use the primer set from the vtyper tool</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>a list of SEQIDs (one per line)</p>
</li>
</ol>
<p><strong>Optional Components</strong></p>
<p>In order to customise your PrimerFinder analyses, several settings can be optionally modified</p>
<ul>
<li>Number of mismatches allowed.<ul>
<li>default is <code>2</code></li>
<li>options are <code>0</code>, <code>1</code>, <code>2</code>, <code>3</code>. Anything else will return an error</li>
<li>modify as follows:<ul>
<li><code>mismatches=1</code></li>
</ul>
</li>
</ul>
</li>
<li>Format of sequence files to use (note that PrimerFinder legacy will still use FASTA-formatted files even if you try 
to specify FASTQ)<ul>
<li>default is <code>fasta</code></li>
<li>options are: <code>fasta</code> and <code>fastq</code></li>
<li>modify as follows:<ul>
<li><code>format=fastq</code></li>
</ul>
</li>
</ul>
</li>
<li>K-mer size to use for SPAdes assembly<ul>
<li>default is <code>55,77,99,127</code></li>
<li>either provide and integer, e.g. <code>33</code>, or a comma-separated list, e.g. <code>21,33,55</code></li>
<li>modify as follows:<ul>
<li><code>kmersize=33</code> <em>OR</em></li>
<li><code>kmersize=21,33,55</code></li>
</ul>
</li>
</ul>
</li>
<li>Export amplicons in PrimerFinder Legacy (amplicons are created by default by PrimerFinder Supremacy)<ul>
<li>default is <code>False</code></li>
<li>modify as follows:<ul>
<li><code>exportamplicons</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="attachments">Attachments</h4>
<p>For <code>custom</code> analyses, you are required to attach a FASTA-formatted file containing the primer set(s) you wish analysed. 
The file must have the following format:</p>
<pre><code>&gt;gene1-F
seq
&gt;gene1-R
seq
&gt;gene2-F1
seq
&gt;gene2-R1
seq
&gt;gene2-F2
seq
&gt;gene2-R2
seq
.....
</code></pre>
<p>You are allowed to use IUPAC degenerate bases in this file. 
<strong>Please don't add too many degenerate bases, as the number of primers combinations can increase quickly.</strong></p>
<pre><code># Dictionary of degenerate IUPAC codes
iupac = {
    'R': ['A', 'G'],
    'Y': ['C', 'T'],
    'S': ['C', 'G'],
    'W': ['A', 'T'],
    'K': ['G', 'T'],
    'M': ['A', 'C'],
    'B': ['C', 'G', 'T'],
    'D': ['A', 'G', 'T'],
    'H': ['A', 'C', 'T'],
    'V': ['A', 'C', 'G'],
    'N': ['A', 'C', 'G', 'T'],
    '-': ['-']
}
</code></pre>
<h4 id="examples">Examples</h4>
<p>Example PrimerFinder analyses:</p>
<p>PrimerFinder Legacy, custom analyses <a href="https://redmine.biodiversity.agr.gc.ca/issues/16084">issue 16084</a></p>
<p>PrimerFinder Legacy, vtyper analyses <a href="https://redmine.biodiversity.agr.gc.ca/issues/16085">issue 16085</a></p>
<p>PrimerFinder Supremacy, custom analyses, FASTA format <a href="https://redmine.biodiversity.agr.gc.ca/issues/16086">issue 16086</a></p>
<p>PrimerFinder Supremacy, custom analyses, FASTQ format <a href="https://redmine.biodiversity.agr.gc.ca/issues/16087">issue 16087</a></p>
<h4 id="interpreting-results">Interpreting Results</h4>
<p><strong>PrimerFinder Legacy</strong></p>
<p>PrimerFinder Legacy will upload <code>ePCR_report.csv</code>, which contains the strain name, gene name as parsed from the primer 
file, location of the calculated amplicon, the size of the amplicon, the name of the contig on which the amplicon was 
found, the total number of mismatches between the primer set and the target sequence, and the primers used to create the amplicon.</p>
<p>Here's an example created using the example primer file from the <code>Attachments</code> section of Redmine <a href="https://redmine.biodiversity.agr.gc.ca/issues/16084">issue 16084</a></p>
<table>
<thead>
<tr>
<th>Sample</th>
<th>Gene</th>
<th>GenomeLocation</th>
<th>AmpliconSize</th>
<th>Contig</th>
<th>TotalMismatches</th>
<th>PrimerSet</th>
</tr>
</thead>
<tbody>
<tr>
<td>2014-SEQ-1390</td>
<td>gene1</td>
<td>30506-30699</td>
<td>194</td>
<td>contig_1</td>
<td>0</td>
<td>gene1_0_0</td>
</tr>
<tr>
<td>2014-SEQ-1390</td>
<td>gene2</td>
<td>476139-476423</td>
<td>285</td>
<td>contig_32</td>
<td>1</td>
<td>gene2_1_1</td>
</tr>
</tbody>
</table>
<p>Note that the way the primer set is numbered is based on the number of primer sets with the same gene name: <em>gene1</em> had 
one primer set, <code>gene1-F</code> and <code>gene1-R</code>, and these are represented as <code>gene1_0_0</code>. There were two
primer sets for <em>gene2</em>, and in this example <code>gene2-F2</code> and <code>gene2-R2</code> annealed (with one mismatch)</p>
<p>If requested, amplicon sequences for each match will be created. Using the same example as above <code>2014-SEQ-1390_amplicons.fa</code> will contain:</p>
<pre><code>&gt;2014-SEQ-1390_contig_1_476139_476423_gene1_0_0
amplicon..... 
&gt;2014-SEQ-1390_contig_32_27409_27668_gene2_1_1
amplicon.....
</code></pre>
<p><strong>PrimerFinder Supremacy</strong></p>
<p>PrimerFinder Supremacy will generate <code>ePCR_report.csv</code>within the <code>consolidated_report</code> folder. This report contains the 
following fields: strain name, gene name parsed from the primer file, location of the amplicon, size of the amplicon, 
name of contig on which the amplicon was found, the forward and reverse primers used to create the amplicon, the number of mismatches for the forward and reverse primers.</p>
<p>Here's an example created using the example primer file from the <code>Attachments</code> section of Redmine <a href="https://redmine.biodiversity.agr.gc.ca/issues/16084">issue 16084</a></p>
<table>
<thead>
<tr>
<th>Sample</th>
<th>Gene</th>
<th>GenomeLocation</th>
<th>AmpliconSize</th>
<th>Contig</th>
<th>ForwardPrimers</th>
<th>ReversePrimers</th>
<th>ForwardMismatches</th>
<th>ReverseMismatches</th>
</tr>
</thead>
<tbody>
<tr>
<td>2014-SEQ-1390</td>
<td>gene1</td>
<td>30506-30699</td>
<td>194</td>
<td>contig_1</td>
<td>gene1-F_0</td>
<td>gene1-R_0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>2014-SEQ-1390</td>
<td>gene2</td>
<td>476139-476423</td>
<td>285</td>
<td>contig_32</td>
<td>gene2-F2_0</td>
<td>gene2-R2_0</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>Note that the primer names have <code>_0</code> appended to the end. In the case of IUPAC bases being present in the primer sequence, this number will be incremented for each primer created to satisfy all possible 
combinations. </p>
<p>Amplicon sequences are always included. Using the same example as above, <code>2014-SEQ-1390_amplicons.fa</code> will contain:</p>
<pre><code>&gt;2014-SEQ-1390_contig_1_gene1-F_0_gene1-R_0
amplicon
&gt;2014-SEQ-1390_contig_32_gene2-F2_0_gene2-R2_0
amplicon
</code></pre>
<p>Raw BLAST results are also uploaded. In the example above, <code>2014-SEQ-1390_rawresults.csv</code> will contain:</p>
<table>
<thead>
<tr>
<th>qseqid</th>
<th>sseqid</th>
<th>positive</th>
<th>mismatch</th>
<th>gaps</th>
<th>evalue</th>
<th>bitscore</th>
<th>slen</th>
<th>length</th>
<th>qstart</th>
<th>qend</th>
<th>qseq</th>
<th>sstart</th>
<th>send</th>
<th>sseq</th>
</tr>
</thead>
<tbody>
<tr>
<td>contig_1</td>
<td>gene1-R_0</td>
<td>25</td>
<td>0</td>
<td>0</td>
<td>3.07E-07</td>
<td>50.1</td>
<td>25</td>
<td>25</td>
<td>476399</td>
<td>476423</td>
<td>TACGGTTCCTTTGACGGTGCGATGA</td>
<td>25</td>
<td>1</td>
<td>TACGGTTCCTTTGACGGTGCGATGA</td>
</tr>
<tr>
<td>contig_1</td>
<td>gene1-F_0</td>
<td>25</td>
<td>0</td>
<td>0</td>
<td>3.07E-07</td>
<td>50.1</td>
<td>25</td>
<td>25</td>
<td>476139</td>
<td>476163</td>
<td>GTGAAATTATCGCCACGTTCGGGCA</td>
<td>1</td>
<td>25</td>
<td>GTGAAATTATCGCCACGTTCGGGCA</td>
</tr>
<tr>
<td>contig_32</td>
<td>gene2-F2_0</td>
<td>20</td>
<td>1</td>
<td>0</td>
<td>4.41E-06</td>
<td>42.1</td>
<td>21</td>
<td>21</td>
<td>27648</td>
<td>27668</td>
<td>CGCCTTATTATACGACCAAAG</td>
<td>21</td>
<td>1</td>
<td>CGCCTTATTTTACGACCAAAG</td>
</tr>
<tr>
<td>contig_32</td>
<td>gene2-R2_0</td>
<td>20</td>
<td>0</td>
<td>0</td>
<td>1.74E-05</td>
<td>40.1</td>
<td>20</td>
<td>20</td>
<td>27409</td>
<td>27428</td>
<td>TGCCCAAAGCAGAGAGATTC</td>
<td>1</td>
<td>20</td>
<td>TGCCCAAAGCAGAGAGATTC</td>
</tr>
</tbody>
</table>
<h3 id="how-long-does-it-take">How long does it take?</h3>
<p>PrimerFinder Legacy and PrimerFinder Supremacy on FASTA mode are very fast (seconds per sample), while PrimerFinder 
Supremacy FASTQ mode is relatively slow (a few minutes per sample)</p>
<h3 id="what-can-go-wrong">What can go wrong?</h3>
<ol>
<li>Requested SEQIDs are not available. </li>
<li>Not including the <code>program=requested_program</code> component, or requesting an unsupported program</li>
<li>Not including the <code>analysis=requested_analysis</code> component, or requesting an unsupported analysis</li>
<li>Specifying an unsupported number of <code>mismatches</code></li>
<li>Incorrectly formatted <code>kmersize</code></li>
<li>Attaching an incorrectly formatted primer file, or not including a primer file for <code>custom</code> analyses</li>
<li>?</li>
</ol>
<p>If anything goes wrong, an error message explaining the error should be returned.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../prokka/" class="btn btn-neutral float-right" title="Prokka"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../pointfinder/" class="btn btn-neutral" title="Pointfinder"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../pointfinder/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../prokka/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
