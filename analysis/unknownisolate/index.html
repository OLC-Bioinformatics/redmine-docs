<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://olc-bioinformatics.github.io/redmine-docs/analysis/unknownisolate/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Unknownisolate - OLC Redmine Automator</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Unknownisolate";
        var mkdocs_page_input_path = "analysis/unknownisolate.md";
        var mkdocs_page_url = "/redmine-docs/analysis/unknownisolate/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> OLC Redmine Automator
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../getting_started/">Getting Started</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Data</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../data/external_retrieve/">External Retrieve</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../data/report_retrieve/">Report Retrieve</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../data/sra_upload/">SRA Upload</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Analysis</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../amrsummary/">AMRsummary</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../autoclark/">AutoCLARK</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bcgtree/">bcgTree</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cardrgi/">CARD-RGI (AMR)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../confindr/">ConFindr</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cowsnphr/">COWSNPhR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../closerelatives/">CloseRelatives</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../eCGF/">eCGF</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ectyper/">ECTyper</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../diversitree/">DiversiTree</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../drep/">dRep-ANI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../fastqc/">Fastqc</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../geneseekr/">GeneSeekr</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gfa_retrieve/">GFA Retrieve</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../pyseer/">GWAS-pyseer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../intimintyper/">IntiminTyper</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../kma/">KMA - Gene Detection</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../kraken2/">Kraken2</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../mashtree/">Mashtree</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../metaphlan/">Metaphlan4</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../mobsuite/">MobSuite</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../neartree/">NearTree</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../plasmidborneidentity/">PlasmidBorneIdentity</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../pointfinder/">PointFinder</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../primerfinder/">PrimerFinder</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../prokka/">Prokka</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../psortb/">PSORTb</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../resfinder/">ResFinder</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../roary/">Roary</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../sequence_extractor/">SequenceExtractor</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../sipprverse/">sipprverse</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../snvphyl/">SNVPhyl</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../snippy/">Snippy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../staramr/">staramr</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../strainmash/">StrainMash</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Unknownisolate</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#what-does-it-do">What does it do?</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#how-do-i-use-it">How do I use it?</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#subject">Subject</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#description">Description</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#example">Example</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#pipeline-description">Pipeline Description</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#interpreting-grobi-report">Interpreting GROBI Report</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#databases-used-by-the-automator">Databases Used by the Automator</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#how-long-does-it-take">How long does it take?</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#what-can-go-wrong">What can go wrong?</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../wgsassembly/">WGS Assembly</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Internal Use</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../internal_only/merge/">Merge</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../troubleshooting/">Troubleshooting</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Tutorials</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../tutorials/open_environment/">Open Environment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tutorials/create_pages/">Create Pages</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tutorials/edit_pages/">Edit Pages</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tutorials/publish_changes/">Publish Changes</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">OLC Redmine Automator</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Analysis</li>
      <li class="breadcrumb-item active">Unknownisolate</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/OLC-LOC-Bioinformatics/OLCRedmineAutomator/edit/master/docs/analysis/unknownisolate.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="unknownisolate-genusspecies-determination">Unknownisolate - Genus/species determination</h1>
<h3 id="what-does-it-do">What does it do?</h3>
<p>The Unknownisolate tool was developed at OLC to output information for species identification of a query sequence. It is ideally used where the MASH and 16S outputs from the COWBAT pipeline don't agree or have a low number of hits (e.g. less than 500/1000 for MASH), or if you are uncertain of the species. The pipeline will first analyse the query sequence assembly using pubMLST and output the closest pubMLST match and support (%), then compare your query to a number of ATCC and RefSeq reference sequences to determine the Average Nucleotide Identity (ANI). The final output will be a Genomic Record of Bacterial Identification (GROBI) pdf report, which will include the pubMLST, ANIb, and ANIm closest match results.</p>
<h3 id="how-do-i-use-it">How do I use it?</h3>
<h4 id="subject">Subject</h4>
<p>In the <code>Subject</code> field, put <code>unknownisolate</code>. Spelling counts, but case sensitivity doesn't.</p>
<h4 id="description">Description</h4>
<p><strong>Required Components</strong></p>
<p>The first line of the description should be the analysis you would like to run (e.g. <code>analysis=enterobacterales</code>). This will depend on what you believe your sequence to be closely related to, if you have an evidence.</p>
<ul>
<li>The following options are currently supported:<ul>
<li><code>bacillus</code> - to compare to genus <i>Bacillus</i></li>
<li><code>custom</code> - to compare to a custom list of SeqIDs - <strong>only recommended if you would like to compare specific sequences... will only include the SeqIDs listed by user, and by excluding reference sequences you are likely to miss something that may be closely related</strong></li>
<li><code>enterobacter</code> - to compare to genus <i>Enterobacter</i></li>
<li><code>enterobacterales</code> - to compare to order Enterobacterales</li>
<li><code>genus</code> - to compare to a specific genus<br />
   The user must also include the line:<ul>
<li><code>genus=QUERY</code> where QUERY is the genus (e.g. <code>genus=Acinetobacter</code>)</li>
</ul>
</li>
<li><code>listeriaceae</code> - to compare to family Listeriaceae</li>
<li><code>mycobacterium</code> - to compare to genus <i>Mycobacterium</i></li>
<li><code>unknown</code> - to compare to all reference sequences. <strong>Will take a long time to run</strong></li>
</ul>
</li>
</ul>
<p>You must also include a query SeqID:</p>
<ul>
<li><code>query=SEQID</code></li>
</ul>
<p><br>
<strong>Optional Components</strong></p>
<p>There are currently no user-options. By default, unknownisolate will run the analysis for query assembly first using pubMLST, then by calculating MASH distances and to filter for the most closely related organisms, and calculate ANI for the query and closely related sequences. If you would like customizable options, please contact a bioinformatician.</p>
<h4 id="example">Example</h4>
<p>For an example unknown isolate analysis, see <a href="https://redmine.biodiversity.agr.gc.ca/issues/33337">issue 33337</a>.</p>
<h4 id="pipeline-description">Pipeline Description</h4>
<p>As mentioned above, unknownisolate will run the analysis for query assembly first using pubMLST, then by calculating MASH distances. The MASH distances are used to sort and filter for the most closely related sequences using the <a href="../neartree/">NearTree</a> automator. For most options, the top 40 related sequences (up to 40, as determined by MASH distance) will be included in subsequent steps; for <i>Mycobacterium</i> only the top 15 closest sequences will be included (this is for computational and time purposes, <i>Mycobacterium</i> takes longer...).
The top related sequences and the query are then compared using <a href="https://drep.readthedocs.io/en/latest/overview.html#genome-comparison">dRep compare</a> to produce a MASHtree output.
The final step is to determine the ANIb and ANIm of the query sequences and close matches, then output the GROBI report as a pdf file.</p>
<h4 id="interpreting-grobi-report">Interpreting GROBI Report</h4>
<ul>
<li>
<p>Output table:</p>
<ul>
<li>The output table on the first page of the GROBI report will include the Matching reference (i.e. Genus and species) for the top hits from rMLST, ANIb, ANIm, and MASH. Example:</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align: center;">Analysis</th>
<th style="text-align: center;">Matching Reference</th>
<th style="text-align: center;">Support</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">rMLST</td>
<td style="text-align: center;">Kosakonia cowanii</td>
<td style="text-align: center;">96%</td>
</tr>
<tr>
<td style="text-align: center;">ANIb</td>
<td style="text-align: center;">KOSAKONIA_COWANII_GCF_004089895</td>
<td style="text-align: center;">0.96877696</td>
</tr>
<tr>
<td style="text-align: center;">ANIm</td>
<td style="text-align: center;">KOSAKONIA_COWANII_GCF_004089895</td>
<td style="text-align: center;">0.96940371</td>
</tr>
<tr>
<td style="text-align: center;">MASH</td>
<td style="text-align: center;">KOSAKONIA_COWANII_GCF_004089895</td>
<td style="text-align: center;">356/1000</td>
</tr>
</tbody>
</table>
<ul>
<li>If species for all analysis types (rMLST, ANIb, ANIm, MASH) are the same, you can likely assume that the species is determined/correct (e.g. above species would be <i>Kosakonia cowanii</i>)
<br>
<br></li>
<li><strong>If the species disagree</strong> - Example:</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align: center;">Analysis</th>
<th style="text-align: center;">Matching Reference</th>
<th style="text-align: center;">Support</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">rMLST</td>
<td style="text-align: center;">Enterobacter sichuanensis</td>
<td style="text-align: center;">13%</td>
</tr>
<tr>
<td style="text-align: center;">ANIb</td>
<td style="text-align: center;">ENTEROBACTER_ASBURIAE_GCF_001521715</td>
<td style="text-align: center;">0.86544877</td>
</tr>
<tr>
<td style="text-align: center;">ANIm</td>
<td style="text-align: center;">ENTEROBACTER_ASBURIAE_GCF_001521715</td>
<td style="text-align: center;">0.87473895</td>
</tr>
<tr>
<td style="text-align: center;">MASH</td>
<td style="text-align: center;">ENTEROBACTER_BUGANDENSIS_GCF_015137655</td>
<td style="text-align: center;">41/1000</td>
</tr>
</tbody>
</table>
<ul>
<li>The table above shows a case where the rMLST, ANIb, ANIm, and MASH results disagree. There is a possibility the sequence is from a novel species, but other precautions should be taken before coming to this conclusion:<ul>
<li>What analysis was selected? If it was custom or genus specific, you may want to select a broader analysis type.</li>
<li>Check that close/probable species are included in our reference files. In the example above, ANIb is still above 80%, so we can be fairly confident this sequence may be an <i>Enterobacter</i> species. You may need to request the current list of reference sequences from ashley.cooper@inspection.gc.ca. Sometimes, especially with Enterobacteriaceae and newly re-classified genera, there are not reference ATCC sequences available. In these cases we have downloaded reference sequences for species not found (e.g. Tatumella and Enterobacter species). The <a href="https://www.ncbi.nlm.nih.gov/datasets/genome/?taxon=1386">Microbial Genome Browser</a> is an excellent resource to look at available genera/species. If you find all possible species that you believe are related are also represented in our database, your sequence 'may' be a novel species.</li>
<li>Contact adam.koziol@inspection.gc.ca and catherine.carrillo@inspection.gc.ca to discuss next steps.</li>
</ul>
</li>
</ul>
</li>
<li>
<p>rMLST (ribosomal Multilocus Sequence Typing):</p>
<ul>
<li>the rMLST support is determined by <a href="https://pubmlst.org/">pubMLST</a>. It is determined using the 53 genes encoding the bacterial ribosome protein subunits (<i>rps</i> genes).</li>
</ul>
</li>
<li>
<p>dRep compare primary clustering dendrogram (tree):
<img alt="test" src="../../img/Primary_clustering_dendrogram_highlighted.jpg" /></p>
<ul>
<li>The dendrogram/tree is produced by the dRep compare bioinformatic program. This output is then taken and the query sequence is highlighted for the GROBI report. The query SeqID will cluster with closely related sequences (as determined by dRep using MASH).</li>
<li>The primary clustering dendrogram output by dRep compare summarizes the pair-wise MASH distance between all genomes in the genome list. The dotted line provides a visualization of the primary ANI threshold (set to 80% for the unknownisolate automator). This tree is not created from genome alignments. This tree is created from the MASH-distances (distances between isolates calculated by MASH). If you would like a phylogenetic tree, please run an automator for tree-building (e.g. bcgtree).</li>
</ul>
</li>
<li>
<p>ANIb:</p>
<ul>
<li>ANI (average nucleotide identity) is a pairwisemeasure of overall similarity between two genome sequences. ANIb analysis is considered the standard method in prokaryotic taxonomy. It uses BLASTN+ for average nucleotide identity calculations. The ANIb method aligns 1020nt fragments of the input sequences. More information regarding ANI calculations can be found at <a href="https://www.sciencedirect.com/science/article/pii/S0580951714000087">Whole-Genome Analyses: ANI</a></li>
</ul>
</li>
<li>
<p>ANIm:</p>
<ul>
<li>ANIm analysis uses MUMmer for average nucleotide identity calculations. The MUMmer program performs ultrafast alignment of two genomes. More information regarding ANI calculations can be found at <a href="https://www.sciencedirect.com/science/article/pii/S0580951714000087">Whole-Genome Analyses: ANI</a></li>
</ul>
</li>
</ul>
<h4 id="databases-used-by-the-automator">Databases Used by the Automator</h4>
<p>For a list of ATCC and RefSeq assemblies currently available/used by the automator, please contact ashley.cooper@inspection.gc.ca or adam.koziol@inspection.gc.ca</p>
<h3 id="how-long-does-it-take">How long does it take?</h3>
<p>The time required for analysis will depend on the analysis type. The unknown analysis will take hours. The <i>Mycobacterium</i> analysis may also take a while.</p>
<h3 id="what-can-go-wrong">What can go wrong?</h3>
<p>1) Requested SEQIDs are not available. If we can't find some of the SEQIDs that you request, you will get a warning message informing you of it.</p>
<p>2) A genus analysis was requested but genus was not specified. You will get a warning message informing you of it. You must also add the flag <code>genus=GENUS</code> for the automator to recognize and select the specific genus' files from the ATCC and RefSeq folders.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../strainmash/" class="btn btn-neutral float-left" title="StrainMash"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../wgsassembly/" class="btn btn-neutral float-right" title="WGS Assembly">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/OLC-LOC-Bioinformatics/OLCRedmineAutomator" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../strainmash/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../wgsassembly/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
